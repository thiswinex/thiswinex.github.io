<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.8.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="偏最小二乘 Partial Least Squares (PLS)">
<meta name="keywords" content="ML">
<meta property="og:type" content="article">
<meta property="og:title" content="PLS简介">
<meta property="og:url" content="http://yoursite.com/2019/11/23/笔记-PLS初探/index.html">
<meta property="og:site_name" content="Thiswinex&#39;s Blog">
<meta property="og:description" content="偏最小二乘 Partial Least Squares (PLS)">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://s2.ax1x.com/2020/03/09/8SgFJJ.png">
<meta property="og:image" content="https://s2.ax1x.com/2020/03/09/8pQcJH.png">
<meta property="og:image" content="https://s2.ax1x.com/2020/03/09/8SgKoD.png">
<meta property="og:updated_time" content="2020-07-27T08:09:29.950Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PLS简介">
<meta name="twitter:description" content="偏最小二乘 Partial Least Squares (PLS)">
<meta name="twitter:image" content="https://s2.ax1x.com/2020/03/09/8SgFJJ.png">

<link rel="canonical" href="http://yoursite.com/2019/11/23/笔记-PLS初探/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-Hans'
  };
</script>

  <title>PLS简介 | Thiswinex's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Thiswinex's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope="" itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/11/23/笔记-PLS初探/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Thiswinex's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          PLS简介
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-11-23 20:42:00" itemprop="dateCreated datePublished" datetime="2019-11-23T20:42:00+08:00">2019-11-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/" itemprop="url" rel="index"><span itemprop="name">ML</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/ML/多元回归/" itemprop="url" rel="index"><span itemprop="name">多元回归</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="偏最小二乘-Partial-Least-Squares-PLS"><a href="#偏最小二乘-Partial-Least-Squares-PLS" class="headerlink" title="偏最小二乘 Partial Least Squares (PLS)"></a>偏最小二乘 Partial Least Squares (PLS)</h2><a id="more"></a>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><ul>
<li><p>适用特点：数据量小、数据维数高、数据多重共线性</p>
</li>
<li><p>为什么？考虑回归问题 $y=\alpha +\beta X+\epsilon$ ，那么最小二乘回归（最大化X、y协方差）</p>
<script type="math/tex; mode=display">
  \beta=(X'X)^{-1}X'y</script><p>即需要 $X’X$ 可逆满秩，$X$ 的样本（行数）需要多于特征（列数），且特征之间没有线性相关性（共线性）。</p>
</li>
<li><p>对比：</p>
<ul>
<li><p>PCA：</p>
</li>
<li><script type="math/tex; mode=display">
X=TP'=T_kP_k'+E\\</script><p>使用SVD求：</p>
</li>
<li><script type="math/tex; mode=display">
X=USV',T=US,P=V,X=TP'</script><p>但是PCA没有利用预测信息即 $y$ ，有些PC和预测没有关系。</p>
</li>
</ul>
</li>
<li><p>PLS模型：</p>
</li>
<li><script type="math/tex; mode=display">
X=TP'+E\\
Y=UQ'+F</script><p>其中 $X$ 为 $n×m$ 观测矩阵，$Y$ 为 $n×p$ 响应矩阵。$T/U$ 为 $n×l$ 的得分矩阵（或成分矩阵），$P/Q$ 为 $m/n ×l$ 的正交载荷矩阵，$E/F$ 为残差。</p>
</li>
<li><p>要求：$\max \text{Cov}(T,U)$ 。类似PCR，观测矩阵被分解为得分矩阵和载荷矩阵的外积，但是PCR中 $X=TP’, T=XW, P=W$ 即权值和载荷相同，这一点不同于PLS（ PLS1中 $w=X’y$ ，正比于X和y的协方差）。</p>
</li>
</ul>
<hr>
<ul>
<li>PLS-CV：<img src="https://s2.ax1x.com/2020/03/09/8SgFJJ.png" alt="image-20191211162109235"></li>
</ul>
<hr>
<h2 id="PLS-算法"><a href="#PLS-算法" class="headerlink" title="PLS 算法"></a>PLS 算法</h2><h3 id="NIPALS"><a href="#NIPALS" class="headerlink" title="NIPALS"></a>NIPALS</h3><ol>
<li><p>令 $X_a, Y_a$ 为观测矩阵和响应矩阵</p>
</li>
<li><p>数据标准化：</p>
</li>
</ol>
<ul>
<li>观测/响应矩阵需要减去对应维度的均值</li>
<li>一般没有除以标准差这一操作</li>
</ul>
<ol>
<li><p>取其中一列 $y$ 作为 $u_1$ （因子）</p>
</li>
<li><p>计算 $X$ 权重：（利用 $u_1$ 信息，用权重实现 $X$ 到因子 $t$ 的变换）</p>
</li>
</ol>
<script type="math/tex; mode=display">
w_1=\frac{X'_{0}u_{1}}{u_1'u_1}\\
w_1\leftarrow \frac{w_1}{\|w_1\|}</script><ol>
<li>计算得分向量（因子）：</li>
</ol>
<script type="math/tex; mode=display">
t_1=X_{0}w_1</script><ol>
<li><p>对 $Y$ 进行相同操作，求得权重 $c_1$ ，因子 $u_1^*$ ，计算 $u$ 的残差是否收敛</p>
</li>
<li><p>计算载荷向量（$p$ 反映 $X$ 和 $t$ 的关系，估计意义上 $X=tp’$：</p>
</li>
</ol>
<script type="math/tex; mode=display">
p_1=X_0'\frac{t_1}{t_1't_1}\\
    q_1=Y_{0}'\frac{u_1}{u_1'u_1}\\</script><ol>
<li>计算新观测矩阵（残差矩阵）：</li>
</ol>
<script type="math/tex; mode=display">
X_1=X_{0}-t_1p_1'\\
b_1=u_1't_1/t_1't_1\\
Y_1=Y_{0}-u_1q_1'=Y_0-b_1t_1q_1'</script><ol>
<li><p>循环</p>
</li>
<li><p>若为回归任务，则任务目标是回归线性模型 $Y=\alpha+X\beta +\epsilon$ ，则 </p>
</li>
</ol>
<script type="math/tex; mode=display">
\hat{\beta}=W(P'W)^{-1}q\\
\hat{\alpha}=\overline{y}-\overline{x}\hat{\beta}</script><p>​                否则需解：</p>
<ul>
<li><script type="math/tex; mode=display">
M=X_{a-1}'Y_{a-1}Y_{a-1}'X_{a-1}</script><p>其最大特征值为 $\theta_a^2$，单位特征向量为 $w_a$ ， $v_a$ 可由其计算得出。</p>
</li>
<li><p>第一轮之后的权重把残差变换到因子，不对原始数据变换</p>
</li>
</ul>
<h3 id="SIMPLS"><a href="#SIMPLS" class="headerlink" title="SIMPLS"></a>SIMPLS</h3><p>$S=X_0’Y_0$</p>
<p><code>for i = 1 to k</code></p>
<p>​    <code>if i=1:</code> $[u,s,v]=SVD(S)$</p>
<p>​    <code>if i&gt;1:</code> $[u,s,v]=SVD(S-P<em>{i-1}(P</em>{i-1}’P<em>{i-1})^{-1}P’</em>{i-1}S)$</p>
<p>​    $r_i=u(:,1)$</p>
<p>​    $t_i=X_0r_i$</p>
<p>​    $p_i=X’_0t_i/t_i’t_i$</p>
<p><code>end</code></p>
<p>$B_{PLS}=R_k(T_k’T_k)^{-1}T_kY_0$</p>
<h3 id="两者比较"><a href="#两者比较" class="headerlink" title="两者比较"></a>两者比较</h3><ul>
<li>NIPALS的权重是相对于各个残差矩阵而言的，解释不便</li>
<li>SIMPLS更快，且是Matlab 标准算法</li>
<li>大部分情况下结果相似，但是高 latent variable 时 SIMPLS 不稳定</li>
</ul>
<p><img src="https://s2.ax1x.com/2020/03/09/8pQcJH.png" alt="image-20191213141042111"></p>
<hr>
<h2 id="Kernel-PLS"><a href="#Kernel-PLS" class="headerlink" title="Kernel PLS"></a>Kernel PLS</h2><ul>
<li>解决非线性问题，和SVM一样可以采用 Kernel 方法：将非线性的低维数据投影到高维后数据变得线性。核函数则用来计算数据在高维空间中的内积。</li>
<li>实验中由于映射未知，核函数无法显式推导，一般只能通过枚举实验。</li>
</ul>
<hr>
<h2 id="PLS分类"><a href="#PLS分类" class="headerlink" title="PLS分类"></a>PLS分类</h2><ul>
<li>PLS-DA</li>
<li>通过 dummy matrix 对响应矩阵编码（类似 one-hot）来分类</li>
<li>处理非线性问题，类别不平衡问题性能会下降</li>
<li>Local weighted PLS：对每个待预测的query，只选出一部分最近的训练样本进行回归建模（多个线性模型来处理非线性）</li>
</ul>
<hr>
<h2 id="Variable-Selection"><a href="#Variable-Selection" class="headerlink" title="Variable Selection"></a>Variable Selection</h2><p><img src="https://s2.ax1x.com/2020/03/09/8SgKoD.png" alt="image-20191212213245596"></p>
<ul>
<li>filter方法，直接从输出中过滤</li>
<li>wrapper：基于filter，选出的变量送回模型重新拟合</li>
<li>embedded的方法，顾名思义即变量选择是PLSR过程的一部分</li>
</ul>
<ul>
<li>loading weight：可以直接用此向量衡量变量重要性</li>
<li>regression coefficients</li>
<li>variable importance in projection</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/ML/" rel="tag"># ML</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/08/26/OJ-LeetCode题解记录-2/" rel="prev" title="LeetCode 题解记录(2)">
      <i class="fa fa-chevron-left"></i> LeetCode 题解记录(2)
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/11/23/笔记-Pytorch问题汇总/" rel="next" title="PyTorch问题汇总">
      PyTorch问题汇总 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#偏最小二乘-Partial-Least-Squares-PLS"><span class="nav-number">1.</span> <span class="nav-text">偏最小二乘 Partial Least Squares (PLS)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#简介"><span class="nav-number">2.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PLS-算法"><span class="nav-number">3.</span> <span class="nav-text">PLS 算法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#NIPALS"><span class="nav-number">3.1.</span> <span class="nav-text">NIPALS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SIMPLS"><span class="nav-number">3.2.</span> <span class="nav-text">SIMPLS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#两者比较"><span class="nav-number">3.3.</span> <span class="nav-text">两者比较</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Kernel-PLS"><span class="nav-number">4.</span> <span class="nav-text">Kernel PLS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PLS分类"><span class="nav-number">5.</span> <span class="nav-text">PLS分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Variable-Selection"><span class="nav-number">6.</span> <span class="nav-text">Variable Selection</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name"></p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">21</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">thiswinex</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
